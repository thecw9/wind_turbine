## 接口说明

- 前端：10.159.1.46
- 后端接口文档：10.159.1.46:8000
- 数字站接口模拟服务：10.159.1.46:8001
- 新增传感器接口服务：10.159.1.46:8003

NOTE: 上述接口只能在校园网内访问，如果你需要在非校园网下访问，请将ip替换为`118.25.99.119`

## TODO

### 站内已有监测平台数据采集接口模拟

| 功能                                                                       | 开发进度       |
| -------------------------------------------------------------------------- | -------------- |
| 南瑞数字站接口模拟（包括数字站测点信息获取接口、数字站实时数据模拟接口等） | **（已完成）** |

### 新增传感器数据采集 **（有BUG,待修复）**

| 功能                                                                                                                         | 开发进度       |
| ---------------------------------------------------------------------------------------------------------------------------- | -------------- |
| 对外提供Restful API形式的外部实时数据接口服务，以便系统能方便地获取实时传感器数据（包括HTTP流式响应接口、HTTP json响应接口） | **（已完成）** |
| 内部集成Kafka消息队列中间件                                                                                                  | **（已完成）** |
| 内部实现数据存储功能                                                                                                         | **（已完成）** |
| FFT频谱接口                                                                                                                  |                |
| 消费者池                                                                                                                     |

同一个硬件设备不能由多个客户端程序同时访问，为了解决这个问题，方法有二：

1. 在内存中开辟一块缓冲区(Buffer)，实时将传感器数据写入缓冲区，不同客户端只需要读取缓冲区内容就可以读取到硬件设备的实时数据。
2. 使用队列(Queue)，将实时数据写入队列，但要注意该队列可以让不同客户端读取相同的数据，不是当一个客户端读取完数据就直接从队列中删除了，而是将数据仍然保留在队列中，通过设置不同客户端的Offset来控制数据读取。

使用Buffer对于读取实时数据的客户端来说是好的，但是对于要用于数据存储的客户端需要有精确的时间控制，不让会导致帧重复或帧缺失的情况，而这往往很难做到。使用Queue的话如果数据消费的不及时可能会导致数据堆积。

为了解决上述问题，可以考虑这种方案，使用定长度的队列，当队列长度超过指定长度时，先进队列的数据溢出。或者可以都要，同时使用Buffer和定长队列。

### 后端

#### 用户认证与管理服务

| 功能                  | 开发进度       |
| --------------------- | -------------- |
| 提供获取用户token API | **（已完成）** |
| 提供新增用户API       | **（已完成）** |
| 提供删除用户API       | **（已完成）** |
| 提供编辑用户API       | **（已完成）** |
| 提供获取用户信息API   | **（已完成）** |

#### 测点数据服务

| 功能                     | 开发进度       |
| ------------------------ | -------------- |
| 提供获取测点信息接口     | **（已完成）** |
| 提供获取测点实时数据接口 | **（已完成）** |
| 提供实时数据存储接口     | **（已完成）** |
| 提供获取历史数据接口     | **（已完成）** |

#### 模型服务。

| 功能                                             | 开发进度       |
| ------------------------------------------------ | -------------- |
| 模型后台训练                                     | **（已完成）** |
| 异步模型训练                                     | **（已完成）** |
| 可控制和管理模型版本                             |                |
| 提供模型信息获取API                              | **（已完成）** |
| 提供模型预测API                                  | **（已完成）** |
| 异步模型预测                                     |                |
| 提供模型详细描述信息(包括训练数据、概率密度曲线) | **（已完成）** |
| 提供实时检测状态的置信度、概率及概率阈值等参数   |                |

#### 融合模型服务

| 功能                                                                                                             | 开发进度       |
| ---------------------------------------------------------------------------------------------------------------- | -------------- |
| 融合数据可控制（通过include、exclude、additional_include和additional_exclude四个字段来控制需要融合的数据有哪些） | **（已完成）** |
| 提供融合模型训练API                                                                                              | **（已完成）** |
| 提供融合模型预测接口API                                                                                          | **（已完成）** |
| 融合环境因素（包括温度、天气等）                                                                                 |                |
| 融合声音数据                                                                                                     |                |

#### 预警模型服务

| 功能                                                   | 开发进度 |
| ------------------------------------------------------ | -------- |
| 提供预警模型训练API                                    |          |
| 提供模型预测API                                        |          |
| 预警模型详细描述信息可视化(包括训练数据、时序预测结果) |          |

#### 模型训练日志服务

| 功能                                                                                   | 开发进度       |
| -------------------------------------------------------------------------------------- | -------------- |
| 提供模型训练日志查看接口（包括模型训练状态[训练失败、正在训练、训练成功]、失败原因等） | **（已完成）** |
| 提供模型训练日志清空接口                                                               | **（已完成）** |

#### 日志服务

| 功能         | 开发进度 |
| ------------ | -------- |
| 日志管理接口 |          |

#### 配置管理服务

提供系统相关配置(模型参数配置、模型训练数据配置、外部接口配置等)等获取和修改服务。

| 功能                    | 开发进度 |
| ----------------------- | -------- |
| 实现配置可修改          |          |
| 提供获取系统配置信息API |          |
| 提供配置修改API         |          |

### 定时任务APP

定时拉去数字站各监测系统实时数据,并进行实时状态诊断和存储

| 功能                                 | 开发进度       |
| ------------------------------------ | -------------- |
| 油色谱数据采集、诊断和存储           | **（已完成）** |
| 局放数据采集、诊断和存储             | **（已完成）** |
| 铁芯夹件接地电流数据采集、诊断和存储 | **（已完成）** |
| SF6在线监测数据采集、诊断和存储      |                |
| 振动数据采集、诊断和存储             |                |
| 融合模型实时诊断和结果存储           | **（已完成）** |
| 预警模型实时诊断和结果存储           |                |

## 部署

### Docker 容器化部署

缺点：

1. 构建的时候需要联网
2. 需要了解Docker镜像、容器、网络、容器卷等概念
3. 数据安全

### Systemd 部署
